/*! ffospushhelper 24-01-2014 */
"use strict";var PushHelper=function a(){if(void 0===typeof navigator.push)throw new Error("No Simple Push API available");var b=[],c=0,d=null,e=[],f=function(a){return localStorage[a]},g=function(a){localStorage[a.name]=a},h=function(c,d,e){if(!c||!e)throw new Error("Invalid parameters please check documentation");var g=f(c);return g||(g={endPoint:null}),g.resolver=d,g.data=e,g.name=c,b.push(g),a},i=function(a){d=a,b.forEach(function(a){a.endPoint||j(a)})},j=function(a){var b=navigator.push.register();c++,b.onsucces=function(){var d=b.result;a.endPoint=d,g(a),c--,k()},b.onerror=function(){e.push({type:"register",data:a.name}),c--,k()}},k=function(){0===c&&null!==d&&d(b)},l=function(){window.navigator.mozSetMessageHandler("push",function(a){var c=a.pushEndpoint,d=a.version,e=b.find(function(a){return a.name===c?a:void 0});return void 0===e?void console.warn("Unknown channel via endpoint "+c+" with version "+d):void(e.resolver?e.resolver(e.data):e.data())})};return{listen:h,register:i,init:l}}();!module&&window?window.PushHelper=PushHelper:module&&(module.exports=PushHelper);